import{a as Ee}from"./chunk-CAQKKX4G.js";import"./chunk-A3WD77X6.js";import{a as Se,b as ye}from"./chunk-3LEP76YH.js";import{b as ve}from"./chunk-LFYJK5GB.js";import{b as be,c as ze}from"./chunk-NN5I4ZQ6.js";import{c as Ce}from"./chunk-36JYQPX4.js";import"./chunk-JQ4W37JH.js";import"./chunk-GOVML6XL.js";import{b as ge}from"./chunk-JM4Q6M5A.js";import{a as K}from"./chunk-GGEG7LNG.js";import{k as ue,l as ce,m as fe,n as he}from"./chunk-QA3WNWTC.js";import"./chunk-ZV26Q6Z5.js";import"./chunk-4V3WCFNY.js";import{R as ne,S as re,T as oe,U as ae,V as le,ba as se,d as A,e as _,f as R,fa as me,g as q,k as j,l as W,o as H,q as G,r as Q,s as J,v as te,w as ie}from"./chunk-K3UCEQBL.js";import"./chunk-HLMBJXKN.js";import{a as _e}from"./chunk-AAN5EPXW.js";import"./chunk-TH67R3V7.js";import"./chunk-3OVYBGXJ.js";import"./chunk-C6FDTAOV.js";import"./chunk-IUQ3UXTC.js";import{Na as Y,Oa as Z,Qa as $,Ra as ee,gb as pe,ja as X,kb as de,ob as x}from"./chunk-R2HTRB5T.js";import"./chunk-HDIAUTON.js";import{w as P}from"./chunk-YRUIOUIJ.js";import{p as U,y as N}from"./chunk-FBUG2U6C.js";import{Db as C,Jb as n,Kb as r,Lb as p,Mb as I,Nb as M,P as y,Pb as V,Xb as c,Zb as g,bc as w,cc as s,jb as h,kb as f,kc as F,lc as k,ma as b,mb as E,oa as v,ob as T,ta as z,tb as m,ua as S,vc as L,wc as O,yc as B,zc as D}from"./chunk-25RHYGPJ.js";import"./chunk-W7ODNIXK.js";function De(l,a){if(l&1&&(I(0),n(1,"form",2)(2,"nz-form-item")(3,"nz-form-label",3),s(4,"\u8BFE\u7A0B\u540D\u79F0"),r(),n(5,"nz-form-control"),p(6,"input",4),r()(),n(7,"nz-form-item")(8,"nz-form-label",3),s(9,"\u8BFE\u7A0B\u8BF4\u660E"),r(),n(10,"nz-form-control"),p(11,"input",5),r()(),n(12,"nz-form-item")(13,"nz-form-label",3),s(14,"\u7AE0\u8282\u540D\u79F0"),r(),n(15,"nz-form-control"),p(16,"input",6),r()(),n(17,"nz-form-item")(18,"nz-form-label",3),s(19,"\u7AE0\u8282\u65F6\u957F(\u5206)"),r(),n(20,"nz-form-control"),p(21,"nz-input-number",7),r()(),n(22,"nz-form-item")(23,"nz-form-label",3),s(24,"\u5C01\u9762\u56FE\u7247"),r(),n(25,"nz-form-control"),p(26,"app-upload",8),r()(),n(27,"nz-form-item")(28,"nz-form-label",3),s(29,"\u5B66\u4E60\u79EF\u5206"),r(),n(30,"nz-form-control"),p(31,"nz-input-number",9),r()(),n(32,"nz-form-item")(33,"nz-form-label",3),s(34,"\u89C6\u9891"),r(),n(35,"nz-form-control"),p(36,"app-upload",10),r()()(),M()),l&2){let d=g();h(1),m("formGroup",d.validateForm),h(20),m("nzMin",1),h(10),m("nzMin",0)}}var Ie=()=>({padding:"15px",height:"70vh","max-height":"100vh"}),Ve=(()=>{let a=class a{get isVisible(){return this._isVisible}set isVisible(e){this._isVisible=e,e&&(this.validateForm.patchValue({}),this.entity&&this.validateForm.patchValue(this.entity))}constructor(e,i,t,o){this.client=e,this.fb=i,this.ouClient=t,this.fileClient=o,this._isVisible=!1,this.isVisibleChange=new T,this.onSuccess=new T,this.validateForm=this.fb.group({studyId:[],title:[null,[_.required]],description:[""],chapterTitle:[null,[_.required]],chapterLength:[0,[_.required]],picUrl:[null,[_.required]],integral:[0,[_.required]],status:[0,[_.required]],videoUrl:[null,[_.required]]}),this.loading=!1,this.cdr=b(E),this.nzCustomRequest=u=>(this.loading=!0,this.fileClient.upload({data:u.file,fileName:u.file.name}).pipe(y(()=>{this.loading=!1})).subscribe(Fe=>{this.avatarUrl=Fe.url})),this.ous=[]}get avatarUrl(){return this.validateForm.value.picUrl?this.fileClient.getBaseUrl("")+"/"+this.validateForm.value.picUrl:""}set avatarUrl(e){this.validateForm.controls.picUrl.setValue(e),this.validateForm.value.picUrl=e,this.cdr.detectChanges()}ngOnInit(){this.getSelectData()}getSelectData(){this.ouClient.getAll().subscribe(e=>{this.ous=e})}handleCancel(){this.validateForm.reset(),this.isVisibleChange.emit(!1)}handleOk(){console.log(this.validateForm),K(this.validateForm)&&this.client.insertOrUpdate(this.validateForm.value).subscribe(()=>{this.onSuccess.emit(),this.handleCancel()})}};a.\u0275fac=function(i){return new(i||a)(f(x),f(G),f(de),f(pe))},a.\u0275cmp=v({type:a,selectors:[["app-study-edit"]],inputs:{isVisible:"isVisible",entity:"entity"},outputs:{isVisibleChange:"isVisibleChange",onSuccess:"onSuccess"},standalone:!0,features:[F],decls:2,vars:3,consts:[["nzTitle","\u7F16\u8F91\u901A\u77E5","nzxModalDrag","","nzWidth","60%",3,"nzVisible","nzBodyStyle","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],["nz-form","",3,"formGroup"],["nzSpan","2","nzRequired",""],["nz-input","","formControlName","title"],["nz-input","","formControlName","description"],["nz-input","","formControlName","chapterTitle"],["formControlName","chapterLength",3,"nzMin"],["formControlName","picUrl","type","pic"],["formControlName","integral",3,"nzMin"],["formControlName","videoUrl","type","file"]],template:function(i,t){i&1&&(n(0,"nz-modal",0),c("nzVisibleChange",function(u){return t.isVisible=u})("nzOnCancel",function(){return t.handleCancel()})("nzOnOk",function(){return t.handleOk()}),C(1,De,37,3,"ng-container",1),r()),i&2&&m("nzVisible",t.isVisible)("nzBodyStyle",k(2,Ie))},dependencies:[N,Q,j,A,R,q,J,W,H,le,ie,te,re,ne,ae,oe,he,fe,ce,Ce,me,se,ye,Se,ve,X,Ee]});let l=a;return l})();var Me=["operationTpl"];function we(l,a){if(l&1){let d=V();n(0,"span",8),c("click",function(){z(d);let i=g().item,t=g();return S(t.send(i))}),s(1,"\u53D1\u5E03"),r()}}function ke(l,a){if(l&1){let d=V();C(0,we,2,0,"span",7),n(1,"span",8),c("click",function(){let t=z(d).item,o=g();return S(o.edit(t))}),s(2,"\u7F16\u8F91"),r(),n(3,"span",8),c("click",function(){let t=z(d).item,o=g();return S(o.del(t))}),s(4,"\u5220\u9664"),r()}if(l&2){let d=a.item;m("ngIf",d.status==0)}}function Le(l,a){if(l&1){let d=V();n(0,"button",9),c("click",function(){z(d);let i=g();return S(i.add())}),p(1,"i",10),s(2," \u65B0\u5EFA "),r()}}var yt=(()=>{let a=class a{constructor(e,i,t){this.client=e,this.modalService=i,this.activeRoute=t,this.pageHeaderInfo={breadcrumb:["\u9996\u9875","\u5BA3\u4F20\u7BA1\u7406","\u515A\u5EFA\u52A8\u6001"]},this.cdr=b(E),this.modalWrapService=b(ge),this.dataList=[],this.searchParam={},this.isEditVisible=!1}ngOnInit(){this.initTable()}initTable(){this.tableConfig={headers:[{title:"\u8BFE\u7A0B\u540D\u79F0",field:"title",width:200},{title:"\u8BFE\u7A0B\u8BF4\u660E",field:"description",width:200},{title:"\u7AE0\u8282\u540D\u79F0",field:"chapterTitle"},{title:"\u7AE0\u8282\u65F6\u957F",field:"chapterLength"},{title:"\u79EF\u5206",field:"integral"},{title:"\u53D1\u5E03\u72B6\u6001",field:"statusDesc"},{title:"\u64CD\u4F5C",tdTemplate:this.operationTpl,width:120,fixed:!0,fixedDir:"right"}],total:0,showCheckbox:!1,loading:!1,pageSize:10,pageIndex:1}}getDataList(e){this.tableConfig.loading=!0,this.searchParam.page={pageSize:this.tableConfig.pageSize,pageIndex:e?.pageIndex||this.tableConfig.pageIndex},this.client.list(this.searchParam).pipe(y(()=>{this.tableLoading(!1)})).subscribe(i=>{let{items:t,page:o}=i;this.dataList=[...t],this.tableConfig.total=o.totalCount,this.tableConfig.pageIndex=o.pageIndex,this.tableLoading(!1)})}add(){this.selectedEntity=null,this.isEditVisible=!0}edit(e){this.selectedEntity=e,this.isEditVisible=!0}del(e){this.modalService.confirm({nzTitle:"\u786E\u5B9A\u5220\u9664?",nzOnOk:()=>{this.client.delete(e.studyId).subscribe(i=>{this.getDataList()})}})}send(e){this.client.send(e.studyId).subscribe(i=>{this.getDataList()})}tableLoading(e){this.tableConfig.loading=e,this.tableChangeDectction()}tableChangeDectction(){this.dataList=[...this.dataList],this.cdr.detectChanges()}changePageSize(e){this.tableConfig.pageSize=e}};a.\u0275fac=function(i){return new(i||a)(f(x),f(ue),f(P))},a.\u0275cmp=v({type:a,selectors:[["app-study"]],viewQuery:function(i,t){if(i&1&&O(Me,7),i&2){let o;L(o=B())&&(t.operationTpl=o.first)}},standalone:!0,features:[F],decls:9,vars:7,consts:[[3,"pageHeaderInfo"],[1,"normal-table-wrap"],[3,"btnTpl","tableTitle","reload"],[3,"tableConfig","tableData","changePageNum","changePageSize"],["operationTpl",""],["tableBtns",""],[3,"entity","isVisible","isVisibleChange","onSuccess"],["class","operate-text",3,"click",4,"ngIf"],[1,"operate-text",3,"click"],["nz-button","","nzType","primary",1,"m-r-8",3,"click"],["nz-icon","","nzType","plus"]],template:function(i,t){if(i&1&&(p(0,"app-page-header",0),n(1,"div",1)(2,"app-card-table-wrap",2),c("reload",function(){return t.getDataList()}),n(3,"app-ant-table",3),c("changePageNum",function(u){return t.getDataList(u)})("changePageSize",function(u){return t.changePageSize(u)}),r(),C(4,ke,5,1,"ng-template",null,4,D),r()(),C(6,Le,3,0,"ng-template",null,5,D),n(8,"app-study-edit",6),c("isVisibleChange",function(u){return t.isEditVisible=u})("onSuccess",function(){return t.getDataList()}),r()),i&2){let o=w(7);m("pageHeaderInfo",t.pageHeaderInfo),h(2),m("btnTpl",o)("tableTitle","\u8BFE\u7A0B\u5217\u8868"),h(1),m("tableConfig",t.tableConfig)("tableData",t.dataList),h(5),m("entity",t.selectedEntity)("isVisible",t.isEditVisible)}},dependencies:[N,U,ee,$,Y,Z,_e,ze,be,Ve]});let l=a;return l})();export{yt as StudyComponent};
