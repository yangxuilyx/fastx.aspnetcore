import{b as Se,c as Ve}from"./chunk-NN5I4ZQ6.js";import{a as _e,b as be,c as ge}from"./chunk-36JYQPX4.js";import"./chunk-JQ4W37JH.js";import"./chunk-GOVML6XL.js";import{a as X}from"./chunk-GGEG7LNG.js";import{k as ce,l as fe,m as ze,n as Ce}from"./chunk-QA3WNWTC.js";import"./chunk-ZV26Q6Z5.js";import"./chunk-4V3WCFNY.js";import{R as oe,S as re,T as ae,U as le,V as se,ba as me,d as j,e as h,f as q,fa as pe,g as H,k as G,l as Q,o as W,q as $,r as J,s as K,v as ie,w as ne}from"./chunk-K3UCEQBL.js";import{a as he}from"./chunk-AAN5EPXW.js";import"./chunk-TH67R3V7.js";import"./chunk-3OVYBGXJ.js";import"./chunk-C6FDTAOV.js";import"./chunk-IUQ3UXTC.js";import{Na as Y,Oa as Z,Qa as ee,Ra as te,kb as ue,mb as de,qb as v}from"./chunk-R2HTRB5T.js";import"./chunk-HDIAUTON.js";import"./chunk-YRUIOUIJ.js";import"./chunk-FBUG2U6C.js";import{Db as _,Fb as y,Hb as N,Ib as T,Jb as t,Kb as i,Lb as d,Mb as A,Nb as B,P as I,Pb as F,Xb as f,Z as w,Zb as C,bc as M,cc as u,jb as m,kb as z,kc as V,lc as k,ma as L,mb as U,oa as b,ob as E,s as D,ta as g,tb as s,ua as S,vc as O,wc as P,yc as R,zc as x}from"./chunk-25RHYGPJ.js";import"./chunk-W7ODNIXK.js";function Te(r,a){if(r&1&&d(0,"nz-option",21),r&2){let p=a.$implicit;s("nzLabel",p.name)("nzValue",p.ouId)}}function Fe(r,a){if(r&1&&d(0,"nz-option",21),r&2){let p=a.$implicit;s("nzLabel",p.name)("nzValue",p.roleId)}}function xe(r,a){if(r&1&&(A(0),t(1,"form",2)(2,"nz-form-item")(3,"nz-form-label",3),u(4,"\u6240\u5C5E\u7EC4\u7EC7"),i(),t(5,"nz-form-control")(6,"nz-select",4),N(7,Te,1,2,"nz-option",21,y),i()()(),t(9,"nz-form-item")(10,"nz-form-label",3),u(11,"\u7528\u6237\u540D"),i(),t(12,"nz-form-control"),d(13,"input",5),i()(),t(14,"nz-form-item")(15,"nz-form-label",3),u(16,"\u5BC6\u7801"),i(),t(17,"nz-form-control"),d(18,"input",6),i()(),t(19,"nz-form-item")(20,"nz-form-label",7),u(21,"\u59D3\u540D"),i(),t(22,"nz-form-control"),d(23,"input",8),i()(),t(24,"nz-form-item")(25,"nz-form-label",3),u(26,"\u624B\u673A\u53F7\u7801"),i(),t(27,"nz-form-control"),d(28,"input",9),i()(),t(29,"nz-form-item")(30,"nz-form-label",3),u(31,"\u8EAB\u4EFD\u8BC1\u53F7"),i(),t(32,"nz-form-control"),d(33,"input",10),i()(),t(34,"nz-form-item")(35,"nz-form-label",3),u(36,"\u515A\u5458\u7C7B\u578B"),i(),t(37,"nz-form-control")(38,"nz-select",11),d(39,"nz-option",12)(40,"nz-option",13)(41,"nz-option",14)(42,"nz-option",15)(43,"nz-option",16),i()()(),t(44,"nz-form-item")(45,"nz-form-label",3),u(46,"\u804C\u52A1"),i(),t(47,"nz-form-control")(48,"nz-select",17),d(49,"nz-option",18)(50,"nz-option",19),i()()(),t(51,"nz-form-item")(52,"nz-form-label",3),u(53,"\u89D2\u8272"),i(),t(54,"nz-form-control")(55,"nz-select",20),N(56,Fe,1,2,"nz-option",21,y),i()()()(),B()),r&2){let p=C();m(1),s("formGroup",p.validateForm),m(6),T(p.ous),m(32),s("nzValue",0),m(1),s("nzValue",1),m(1),s("nzValue",2),m(1),s("nzValue",3),m(1),s("nzValue",4),m(6),s("nzValue",0),m(1),s("nzValue",1),m(6),T(p.roles)}}var De=()=>({padding:"15px",height:"70vh"}),ve=(()=>{let a=class a{get isVisible(){return this._isVisible}set isVisible(e){this._isVisible=e,e&&this.entity?(console.log(this.entity),this.validateForm.patchValue(this.entity),this.validateForm.controls.password.disable()):this.validateForm.controls.password.enable()}constructor(e,n,o,l){this.client=e,this.ouClient=n,this.roleClient=o,this.fb=l,this._isVisible=!1,this.isVisibleChange=new E,this.onSuccess=new E,this.validateForm=this.fb.group({userId:[],userName:["",h.required],name:["",h.required],phoneNumber:[[],h.required],idNo:[],userType:[0,[h.required]],ouId:[],positionType:[0],password:["",h.required],roles:[[]]}),this.ous=[],this.roles=[]}ngOnInit(){this.getAll()}getAll(){this.ouClient.getAll().pipe(w(e=>this.roleClient.getAll().pipe(D(n=>({roles:n,ous:e}))))).subscribe(e=>{this.ous=e.ous,this.roles=e.roles})}handleCancel(){this.validateForm.reset(),this.isVisibleChange.emit(!1)}handleOk(){X(this.validateForm)&&(this.validateForm.value.userId?this.client.update(this.validateForm.value).subscribe(()=>{this.onSuccess.emit(),this.handleCancel()}):this.client.insert(this.validateForm.value).subscribe(()=>{this.onSuccess.emit(),this.handleCancel()}))}};a.\u0275fac=function(n){return new(n||a)(z(v),z(ue),z(de),z($))},a.\u0275cmp=b({type:a,selectors:[["app-user-edit"]],inputs:{isVisible:"isVisible",entity:"entity"},outputs:{isVisibleChange:"isVisibleChange",onSuccess:"onSuccess"},standalone:!0,features:[V],decls:2,vars:3,consts:[["nzTitle","\u7F16\u8F91\u515A\u5458","nzxModalDrag","","nzWidth","60%",3,"nzVisible","nzBodyStyle","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],["nz-form","",3,"formGroup"],["nzSpan","2"],["formControlName","ouId","nzShowSearch","","nzAllowClear",""],["nz-input","","formControlName","userName"],["nz-input","","formControlName","password","type","password"],["nzRequired","","nzSpan","2"],["nz-input","","formControlName","name"],["nz-input","","formControlName","phoneNumber"],["nz-input","","formControlName","idNo"],["formControlName","userType"],["nzLabel","\u7FA4\u4F17",3,"nzValue"],["nzLabel","\u6B63\u5F0F\u515A\u5458",3,"nzValue"],["nzLabel","\u9884\u5907\u515A\u5458",3,"nzValue"],["nzLabel","\u53D1\u5C55\u5BF9\u8C61",3,"nzValue"],["nzLabel","\u5165\u515A\u79EF\u6781\u5206\u5B50",3,"nzValue"],["formControlName","positionType"],["nzLabel","\u666E\u901A\u7528\u6237",3,"nzValue"],["nzLabel","\u90E8\u95E8\u9886\u5BFC",3,"nzValue"],["nzMode","multiple","formControlName","roles"],[3,"nzLabel","nzValue"]],template:function(n,o){n&1&&(t(0,"nz-modal",0),f("nzVisibleChange",function(c){return o.isVisible=c})("nzOnCancel",function(){return o.handleCancel()})("nzOnOk",function(){return o.handleOk()}),_(1,xe,58,8,"ng-container",1),i()),n&2&&s("nzVisible",o.isVisible)("nzBodyStyle",k(2,De))},dependencies:[J,G,j,q,H,K,Q,W,se,ne,ie,re,oe,le,ae,Ce,ze,fe,ge,_e,be,pe,me]});let r=a;return r})();var Ie=["operationTpl"];function we(r,a){if(r&1){let p=F();t(0,"span",7),f("click",function(){let o=g(p).item,l=C();return S(l.edit(o))}),u(1,"\u7F16\u8F91"),i(),t(2,"span",7),f("click",function(){let o=g(p).item,l=C();return S(l.del(o))}),u(3,"\u5220\u9664"),i()}}function Le(r,a){if(r&1){let p=F();t(0,"button",8),f("click",function(){g(p);let n=C();return S(n.add())}),d(1,"i",9),u(2," \u65B0\u5EFA "),i()}}var mt=(()=>{let a=class a{constructor(e,n){this.userClient=e,this.modalService=n,this.pageHeaderInfo={breadcrumb:["\u9996\u9875","\u515A\u52A1\u7BA1\u7406\u5E73\u53F0","\u515A\u5458\u7BA1\u7406"]},this.cdr=L(U),this.dataList=[],this.isEditVisible=!1}ngOnInit(){this.initTable()}initTable(){this.tableConfig={headers:[{title:"\u7528\u6237\u540D",field:"userName"},{title:"\u59D3\u540D",field:"name"},{title:"\u624B\u673A\u53F7\u7801",field:"phoneNumber"},{title:"\u8EAB\u4EFD\u8BC1\u53F7",field:"idNo"},{title:"\u515A\u5458\u7C7B\u578B",field:"userTypeDesc"},{title:"\u804C\u52A1",field:"positionTypeDesc"},{title:"\u64CD\u4F5C",tdTemplate:this.operationTpl}],total:0,showCheckbox:!1,loading:!1,pageSize:10,pageIndex:1}}getDataList(e){this.tableConfig.loading=!0;let n={page:{pageSize:this.tableConfig.pageSize,pageIndex:e?.pageIndex||this.tableConfig.pageIndex}};this.userClient.list(n).pipe(I(()=>{this.tableLoading(!1)})).subscribe(o=>{let{items:l,page:c}=o;this.dataList=[...l],this.tableConfig.total=c.totalCount,this.tableConfig.pageIndex=c.pageIndex,this.tableLoading(!1)})}add(){this.selectedUser=null,this.isEditVisible=!0}edit(e){this.selectedUser=e,this.isEditVisible=!0}del(e){this.modalService.confirm({nzTitle:"\u786E\u5B9A\u5220\u9664?",nzOnOk:()=>{this.userClient.delete(e.userId).subscribe(n=>{this.getDataList()})}})}tableLoading(e){this.tableConfig.loading=e,this.tableChangeDectction()}tableChangeDectction(){this.dataList=[...this.dataList],this.cdr.detectChanges()}changePageSize(e){this.tableConfig.pageSize=e}};a.\u0275fac=function(n){return new(n||a)(z(v),z(ce))},a.\u0275cmp=b({type:a,selectors:[["app-user"]],viewQuery:function(n,o){if(n&1&&P(Ie,7),n&2){let l;O(l=R())&&(o.operationTpl=l.first)}},standalone:!0,features:[V],decls:9,vars:7,consts:[[3,"pageHeaderInfo"],[1,"normal-table-wrap"],[3,"btnTpl","tableTitle","reload"],[3,"tableConfig","tableData","changePageNum","changePageSize"],["operationTpl",""],["tableBtns",""],[3,"entity","isVisible","isVisibleChange","onSuccess"],[1,"operate-text",3,"click"],["nz-button","","nzType","primary",1,"m-r-8",3,"click"],["nz-icon","","nzType","plus"]],template:function(n,o){if(n&1&&(d(0,"app-page-header",0),t(1,"div",1)(2,"app-card-table-wrap",2),f("reload",function(){return o.getDataList()}),t(3,"app-ant-table",3),f("changePageNum",function(c){return o.getDataList(c)})("changePageSize",function(c){return o.changePageSize(c)}),i(),_(4,we,4,0,"ng-template",null,4,x),i()(),_(6,Le,3,0,"ng-template",null,5,x),t(8,"app-user-edit",6),f("isVisibleChange",function(c){return o.isEditVisible=c})("onSuccess",function(){return o.getDataList()}),i()),n&2){let l=M(7);s("pageHeaderInfo",o.pageHeaderInfo),m(2),s("btnTpl",l)("tableTitle","\u515A\u5458\u7BA1\u7406"),m(1),s("tableConfig",o.tableConfig)("tableData",o.dataList),m(5),s("entity",o.selectedUser)("isVisible",o.isEditVisible)}},dependencies:[te,ee,Y,Z,he,Ve,Se,ve]});let r=a;return r})();export{mt as UserComponent};
