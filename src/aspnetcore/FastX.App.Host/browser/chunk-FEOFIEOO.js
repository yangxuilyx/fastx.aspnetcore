import{a as _e,c as ge}from"./chunk-NN5I4ZQ6.js";import{a as he,b as Ce,c as ze}from"./chunk-36JYQPX4.js";import"./chunk-JQ4W37JH.js";import"./chunk-GOVML6XL.js";import{b as ce}from"./chunk-JM4Q6M5A.js";import{a as J}from"./chunk-GGEG7LNG.js";import{k as me,l as pe,m as ue,n as de}from"./chunk-QA3WNWTC.js";import"./chunk-ZV26Q6Z5.js";import"./chunk-4V3WCFNY.js";import{R as ie,S as ne,T as oe,U as ae,V as re,ba as le,d as R,e as j,f as H,fa as se,g as P,k as W,l as G,o as Q,q,r as U,s as $,v as ee,w as te}from"./chunk-K3UCEQBL.js";import"./chunk-HLMBJXKN.js";import{a as fe}from"./chunk-AAN5EPXW.js";import"./chunk-TH67R3V7.js";import"./chunk-3OVYBGXJ.js";import"./chunk-C6FDTAOV.js";import"./chunk-IUQ3UXTC.js";import{Na as K,Oa as X,Qa as Y,Ra as Z,kb as v}from"./chunk-R2HTRB5T.js";import"./chunk-HDIAUTON.js";import"./chunk-YRUIOUIJ.js";import"./chunk-FBUG2U6C.js";import{Db as z,Fb as x,Hb as F,Ib as D,Jb as n,Kb as o,Lb as d,Mb as I,Nb as w,P as T,Pb as y,Xb as c,Zb as h,bc as L,cc as u,jb as m,kb as f,kc as V,lc as k,ma as S,mb as N,oa as _,ob as E,ta as g,tb as s,ua as b,vc as M,wc as A,yc as B,zc as O}from"./chunk-25RHYGPJ.js";import"./chunk-W7ODNIXK.js";function Ee(r,a){if(r&1&&d(0,"nz-option",15),r&2){let p=a.$implicit;s("nzLabel",p.name)("nzValue",p.ouId)}}function ye(r,a){if(r&1&&(I(0),n(1,"form",2)(2,"nz-form-item")(3,"nz-form-label",3),u(4,"\u6240\u5C5E\u7EC4\u7EC7"),o(),n(5,"nz-form-control")(6,"nz-select",4),F(7,Ee,1,2,"nz-option",15,x),o()()(),n(9,"nz-form-item")(10,"nz-form-label",3),u(11,"\u7EC4\u7EC7\u7EA7\u522B"),o(),n(12,"nz-form-control")(13,"nz-select",5),d(14,"nz-option",6)(15,"nz-option",7)(16,"nz-option",8)(17,"nz-option",9)(18,"nz-option",10),o()()(),n(19,"nz-form-item")(20,"nz-form-label",11),u(21,"\u7EC4\u7EC7\u540D\u79F0"),o(),n(22,"nz-form-control"),d(23,"input",12),o()(),n(24,"nz-form-item")(25,"nz-form-label",3),u(26,"\u7535\u8BDD"),o(),n(27,"nz-form-control"),d(28,"input",13),o()(),n(29,"nz-form-item")(30,"nz-form-label",3),u(31,"\u5730\u5740"),o(),n(32,"nz-form-control"),d(33,"input",14),o()()(),w()),r&2){let p=h();m(1),s("formGroup",p.validateForm),m(6),D(p.ous),m(7),s("nzValue",0),m(1),s("nzValue",1),m(1),s("nzValue",2),m(1),s("nzValue",3),m(1),s("nzValue",4)}}var Oe=()=>({padding:"15px",height:"70vh"}),be=(()=>{let a=class a{get isVisible(){return this._isVisible}set isVisible(e){this._isVisible=e,e&&(this.getAll(),this.ou&&this.validateForm.patchValue(this.ou))}constructor(e,t){this.ouClient=e,this.fb=t,this._isVisible=!1,this.isVisibleChange=new E,this.onSuccess=new E,this.validateForm=this.fb.group({ouId:[],name:[[],j.required],phone:[],address:[],ouType:[0],parentId:[]}),this.ous=[]}ngOnInit(){this.getAll()}getAll(){this.ouClient.getAll().subscribe(e=>{this.ous=e})}handleCancel(){this.validateForm.reset(),this.isVisibleChange.emit(!1)}handleOk(){J(this.validateForm)&&this.ouClient.insertOrUpdate(this.validateForm.value).subscribe(()=>{this.onSuccess.emit(),this.handleCancel()})}};a.\u0275fac=function(t){return new(t||a)(f(v),f(q))},a.\u0275cmp=_({type:a,selectors:[["app-ou-edit"]],inputs:{isVisible:"isVisible",ou:"ou"},outputs:{isVisibleChange:"isVisibleChange",onSuccess:"onSuccess"},standalone:!0,features:[V],decls:2,vars:3,consts:[["nzTitle","\u7F16\u8F91\u7EC4\u7EC7","nzxModalDrag","","nzWidth","60%",3,"nzVisible","nzBodyStyle","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],["nz-form","",3,"formGroup"],["nzSpan","2"],["formControlName","parentId","nzShowSearch","","nzAllowClear",""],["formControlName","ouType"],["nzLabel","\u515A\u652F\u90E8",3,"nzValue"],["nzLabel","\u515A\u603B\u652F",3,"nzValue"],["nzLabel","\u515A\u59D4",3,"nzValue"],["nzLabel","\u529E\u516C\u5BA4",3,"nzValue"],["nzLabel","\u90E8\u95E8",3,"nzValue"],["nzRequired","","nzSpan","2"],["nz-input","","formControlName","name"],["nz-input","","formControlName","phone"],["nz-input","","formControlName","address"],[3,"nzLabel","nzValue"]],template:function(t,i){t&1&&(n(0,"nz-modal",0),c("nzVisibleChange",function(C){return i.isVisible=C})("nzOnCancel",function(){return i.handleCancel()})("nzOnOk",function(){return i.handleOk()}),z(1,ye,34,6,"ng-container",1),o()),t&2&&s("nzVisible",i.isVisible)("nzBodyStyle",k(2,Oe))},dependencies:[U,W,R,H,P,$,G,Q,re,te,ee,ne,ie,ae,oe,de,ue,pe,ze,he,Ce,se,le]});let r=a;return r})();var Te=["operationTpl"];function Ne(r,a){if(r&1){let p=y();n(0,"span",7),c("click",function(){let i=g(p).item,l=h();return b(l.edit(i))}),u(1,"\u7F16\u8F91"),o(),n(2,"span",7),c("click",function(){let i=g(p).item,l=h();return b(l.del(i))}),u(3,"\u5220\u9664"),o()}}function xe(r,a){if(r&1){let p=y();n(0,"button",8),c("click",function(){g(p);let t=h();return b(t.add())}),d(1,"i",9),u(2," \u65B0\u5EFA "),o()}}var at=(()=>{let a=class a{constructor(e,t){this.ouClient=e,this.nzModalService=t,this.pageHeaderInfo={breadcrumb:["\u9996\u9875","\u515A\u52A1\u7BA1\u7406\u5E73\u53F0","\u7EC4\u7EC7\u7BA1\u7406"]},this.cdr=S(N),this.modalWrapService=S(ce),this.dataList=[],this.checkedCashArray=[],this.editVisible=!1}ngOnInit(){this.initTable()}reloadTable(){this.getDataList()}initTable(){this.tableConfig={headers:[{title:"\u7EC4\u7EC7\u540D\u79F0",field:"name",tdClassList:["operate-text"]},{title:"\u7EC4\u7EC7\u7EA7\u522B",field:"ouTypeDesc"},{title:"\u7535\u8BDD",field:"phone"},{title:"\u5730\u5740",field:"address"},{title:"\u64CD\u4F5C",tdTemplate:this.operationTpl,width:130,fixed:!0,fixedDir:"right"}],total:0,showCheckbox:!1,loading:!1,pageSize:10,pageIndex:1}}getDataList(e){this.tableConfig.loading=!0;let t={page:{pageSize:this.tableConfig.pageSize,pageIndex:e?.pageIndex||this.tableConfig.pageIndex}};this.ouClient.list(t).pipe(T(()=>{this.tableLoading(!1)})).subscribe(i=>{this.dataList=[...i.items||[]],this.tableConfig.total=i.page?.totalCount,this.tableConfig.pageIndex=t.page.pageIndex,this.checkedCashArray=[...this.checkedCashArray],this.tableLoading(!1)})}tableLoading(e){this.tableConfig.loading=e,this.tableChangeDectction()}tableChangeDectction(){this.dataList=[...this.dataList],this.cdr.detectChanges()}add(){this.selectedOu=null,this.editVisible=!0}del(e){this.nzModalService.confirm({nzTitle:"\u786E\u5B9A\u5220\u9664?",nzOnOk:()=>{this.ouClient.delete(e.ouId).subscribe(t=>{this.getDataList()})}})}edit(e){this.selectedOu=e,this.editVisible=!0}};a.\u0275fac=function(t){return new(t||a)(f(v),f(me))},a.\u0275cmp=_({type:a,selectors:[["app-ou"]],viewQuery:function(t,i){if(t&1&&A(Te,7),t&2){let l;M(l=B())&&(i.operationTpl=l.first)}},standalone:!0,features:[V],decls:9,vars:7,consts:[[3,"pageHeaderInfo"],[1,"normal-table-wrap"],[3,"btnTpl","reload"],[3,"cashArray","tableConfig","tableData","changePageNum"],["operationTpl",""],["tableBtns",""],[3,"ou","isVisible","isVisibleChange","onSuccess"],[1,"operate-text",3,"click"],["nz-button","","nzType","primary",1,"m-r-8",3,"click"],["nz-icon","","nzType","plus"]],template:function(t,i){if(t&1&&(d(0,"app-page-header",0),n(1,"div",1)(2,"app-card-table-wrap",2),c("reload",function(){return i.reloadTable()}),n(3,"app-tree-table",3),c("changePageNum",function(C){return i.getDataList(C)}),o(),z(4,Ne,4,0,"ng-template",null,4,O),o()(),z(6,xe,3,0,"ng-template",null,5,O),n(8,"app-ou-edit",6),c("isVisibleChange",function(C){return i.editVisible=C})("onSuccess",function(){return i.getDataList()}),o()),t&2){let l=L(7);s("pageHeaderInfo",i.pageHeaderInfo),m(2),s("btnTpl",l),m(1),s("cashArray",i.checkedCashArray)("tableConfig",i.tableConfig)("tableData",i.dataList),m(5),s("ou",i.selectedOu)("isVisible",i.editVisible)}},dependencies:[Z,Y,K,X,fe,ge,_e,be]});let r=a;return r})();export{at as OuComponent};
