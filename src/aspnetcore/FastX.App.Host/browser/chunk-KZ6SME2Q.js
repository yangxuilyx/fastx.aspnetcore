import{b as Mt}from"./chunk-HX46T5TW.js";import"./chunk-CAQKKX4G.js";import{b as Lt}from"./chunk-3LEP76YH.js";import"./chunk-LFYJK5GB.js";import{a as rt}from"./chunk-6RI7L6ZC.js";import{b as Pt,c as Ft}from"./chunk-NN5I4ZQ6.js";import{c as ne,f as yt,h as Et,j as kt,m as Dt,n as Ot,o as Nt,p as Tt,q as jt}from"./chunk-36JYQPX4.js";import"./chunk-JQ4W37JH.js";import"./chunk-GOVML6XL.js";import{a as Ye}from"./chunk-GGEG7LNG.js";import{g as bt,h as zt,k as pe,l as xt,m as St,n as wt}from"./chunk-QA3WNWTC.js";import"./chunk-ZV26Q6Z5.js";import"./chunk-4V3WCFNY.js";import{R as dt,S as pt,T as ht,V as ee,ba as ut,d as $e,f as Be,fa as te,g as Qe,k as Ze,l as He,m as We,n as qe,o as Ge,q as Ke,r as q,s as G,v as lt,w as mt}from"./chunk-K3UCEQBL.js";import{a as It}from"./chunk-AAN5EPXW.js";import"./chunk-TH67R3V7.js";import{b as _t}from"./chunk-3OVYBGXJ.js";import"./chunk-C6FDTAOV.js";import"./chunk-IUQ3UXTC.js";import{Ea as nt,Fa as ot,Ia as Y,J as Je,Ja as at,Na as st,Qa as ct,Ra as J,S as K,T as $,W as et,cb as gt,db as ft,eb as ie,ia as tt,ja as it,kb as vt,l as me,qb as Ct,t as Xe,va as X,wa as de}from"./chunk-R2HTRB5T.js";import"./chunk-HDIAUTON.js";import{o as Ae,w as Ve,z as Ue}from"./chunk-YRUIOUIJ.js";import{d as Fe,g as Me,o as Le,p as Re}from"./chunk-FBUG2U6C.js";import{$a as Se,$b as Te,D as re,Db as _,Eb as k,Fb as ye,Ha as H,Hb as Ee,Ib as ke,Jb as c,K as Z,Kb as s,Lb as C,Mb as D,Nb as O,P as ge,Pb as w,Rb as De,Xb as f,Yb as Oe,Z as fe,Zb as h,_ as b,_b as Ne,bc as je,cb as se,cc as u,dc as N,f as j,ga as ve,ha as Ce,hc as Pe,jb as p,kb as l,kc as E,la as M,lc as ce,m as P,ma as _e,mb as L,oa as I,ob as y,pa as be,pb as we,qa as ze,sa as xe,sb as Ie,ta as x,tb as g,ua as S,ub as W,vb as R,vc as A,wc as V,yc as U,z as F,zc as le}from"./chunk-25RHYGPJ.js";import{a as z}from"./chunk-W7ODNIXK.js";var Xt=["imgRef"],Yt=["imagePreviewWrapper"];function Jt(i,n){if(i&1){let a=w();c(0,"li",10),f("click",function(){let o=x(a).$implicit;return S(o.onClick())}),C(1,"span",11),s()}if(i&2){let a=n.$implicit,e=h();R("ant-image-preview-operations-operation-disabled",e.zoomOutDisabled&&a.type==="zoomOut"),p(1),g("nzType",a.icon)}}function ei(i,n){if(i&1&&C(0,"img",13,14),i&2){let a=h().$implicit,e=h();W("width",a.width)("height",a.height)("transform",e.previewImageTransform),Ie("src",e.sanitizerResourceUrl(a.src),Se)("srcset",a.srcset)("alt",a.alt)}}function ti(i,n){if(i&1&&(D(0),_(1,ei,2,9,"img",12),O()),i&2){let a=n.index,e=h();p(1),g("ngIf",e.index===a)}}function ii(i,n){if(i&1){let a=w();D(0),c(1,"div",15),f("click",function(t){x(a);let o=h();return S(o.onSwitchLeft(t))}),C(2,"span",16),s(),c(3,"div",17),f("click",function(t){x(a);let o=h();return S(o.onSwitchRight(t))}),C(4,"span",18),s(),O()}if(i&2){let a=h();p(1),R("ant-image-preview-switch-left-disabled",a.index<=0),p(2),R("ant-image-preview-switch-right-disabled",a.index>=a.images.length-1)}}var ni=["*"],oe={enter:"ant-fade-enter",enterActive:"ant-fade-enter-active",leave:"ant-fade-leave",leaveActive:"ant-fade-leave-active"},oi="ant-image-preview-mask",Bt="image";function ai(i){let n={};return i.width<=i.clientWidth&&i.height<=i.clientHeight&&(n={x:0,y:0}),(i.width>i.clientWidth||i.height>i.clientHeight)&&(n={x:Ut(i.left,i.width,i.clientWidth),y:Ut(i.top,i.height,i.clientHeight)}),n}function ri(i){let n=i.getBoundingClientRect(),a=document.documentElement;return{left:n.left+(window.pageXOffset||a.scrollLeft)-(a.clientLeft||document.body.clientLeft||0),top:n.top+(window.pageYOffset||a.scrollTop)-(a.clientTop||document.body.clientTop||0)}}function si(){let i=document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight;return{width:i,height:n}}function Ut(i,n,a){let e=i+n,t=(n-a)/2,o=null;return n>a?(i>0&&(o=t),i<0&&e<a&&(o=-t)):(i<0||e>a)&&(o=i<0?t:-t),o}var B=class{constructor(){this.nzKeyboard=!0,this.nzNoAnimation=!1,this.nzMaskClosable=!0,this.nzCloseOnNavigation=!0}},ae={x:0,y:0},he=.5,ci=1,li=0,Qt=(()=>{let n=class n{get animationDisabled(){return this.config.nzNoAnimation??!1}get maskClosable(){let e=this.nzConfigService.getConfigForComponent(Bt)||{};return this.config.nzMaskClosable??e.nzMaskClosable??!0}constructor(e,t,o,r,m,d,v,Q){this.ngZone=e,this.host=t,this.cdr=o,this.nzConfigService=r,this.config=m,this.overlayRef=d,this.destroy$=v,this.sanitizer=Q,this._defaultNzZoom=ci,this._defaultNzScaleStep=he,this._defaultNzRotate=li,this.images=[],this.index=0,this.isDragging=!1,this.visible=!0,this.animationState="enter",this.animationStateChanged=new y,this.scaleStepMap=new Map,this.previewImageTransform="",this.previewImageWrapperTransform="",this.operations=[{icon:"close",onClick:()=>{this.onClose()},type:"close"},{icon:"zoom-in",onClick:()=>{this.onZoomIn()},type:"zoomIn"},{icon:"zoom-out",onClick:()=>{this.onZoomOut()},type:"zoomOut"},{icon:"rotate-right",onClick:()=>{this.onRotateRight()},type:"rotateRight"},{icon:"rotate-left",onClick:()=>{this.onRotateLeft()},type:"rotateLeft"}],this.zoomOutDisabled=!1,this.position=z({},ae),this.containerClick=new y,this.closeClick=new y,this.zoom=this.config.nzZoom??this._defaultNzZoom,this.scaleStep=this.config.nzScaleStep??this._defaultNzScaleStep,this.rotate=this.config.nzRotate??this._defaultNzRotate,this.updateZoomOutDisabled(),this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform()}ngOnInit(){this.ngZone.runOutsideAngular(()=>{F(this.host.nativeElement,"click").pipe(b(this.destroy$)).subscribe(e=>{e.target===e.currentTarget&&this.maskClosable&&this.containerClick.observers.length&&this.ngZone.run(()=>this.containerClick.emit())}),F(this.imagePreviewWrapper.nativeElement,"mousedown").pipe(b(this.destroy$)).subscribe(()=>{this.isDragging=!0})})}setImages(e,t){t&&(this.scaleStepMap=t),this.images=e,this.cdr.markForCheck()}switchTo(e){this.index=e,this.cdr.markForCheck()}next(){this.index<this.images.length-1&&(this.reset(),this.index++,this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform(),this.updateZoomOutDisabled(),this.cdr.markForCheck())}prev(){this.index>0&&(this.reset(),this.index--,this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform(),this.updateZoomOutDisabled(),this.cdr.markForCheck())}markForCheck(){this.cdr.markForCheck()}onClose(){this.closeClick.emit()}onZoomIn(){let e=this.scaleStepMap.get(this.images[this.index].src??this.images[this.index].srcset)??this.scaleStep;this.zoom+=e,this.updatePreviewImageTransform(),this.updateZoomOutDisabled(),this.position=z({},ae)}onZoomOut(){if(this.zoom>1){let e=this.scaleStepMap.get(this.images[this.index].src??this.images[this.index].srcset)??this.scaleStep;this.zoom-=e,this.updatePreviewImageTransform(),this.updateZoomOutDisabled(),this.position=z({},ae)}}onRotateRight(){this.rotate+=90,this.updatePreviewImageTransform()}onRotateLeft(){this.rotate-=90,this.updatePreviewImageTransform()}onSwitchLeft(e){e.preventDefault(),e.stopPropagation(),this.prev()}onSwitchRight(e){e.preventDefault(),e.stopPropagation(),this.next()}onAnimationStart(e){e.toState==="enter"?this.setEnterAnimationClass():e.toState==="leave"&&this.setLeaveAnimationClass(),this.animationStateChanged.emit(e)}onAnimationDone(e){e.toState==="enter"?this.setEnterAnimationClass():e.toState==="leave"&&this.setLeaveAnimationClass(),this.animationStateChanged.emit(e)}startLeaveAnimation(){this.animationState="leave",this.cdr.markForCheck()}onDragReleased(){this.isDragging=!1;let e=this.imageRef.nativeElement.offsetWidth*this.zoom,t=this.imageRef.nativeElement.offsetHeight*this.zoom,{left:o,top:r}=ri(this.imageRef.nativeElement),{width:m,height:d}=si(),v=this.rotate%180!==0,T=ai({width:v?t:e,height:v?e:t,left:o,top:r,clientWidth:m,clientHeight:d});(me(T.x)||me(T.y))&&(this.position=z(z({},this.position),T))}sanitizerResourceUrl(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}updatePreviewImageTransform(){this.previewImageTransform=`scale3d(${this.zoom}, ${this.zoom}, 1) rotate(${this.rotate}deg)`}updatePreviewImageWrapperTransform(){this.previewImageWrapperTransform=`translate3d(${this.position.x}px, ${this.position.y}px, 0)`}updateZoomOutDisabled(){this.zoomOutDisabled=this.zoom<=1}setEnterAnimationClass(){if(this.animationDisabled)return;let e=this.overlayRef.backdropElement;e&&(e.classList.add(oe.enter),e.classList.add(oe.enterActive))}setLeaveAnimationClass(){if(this.animationDisabled)return;let e=this.overlayRef.backdropElement;e&&(e.classList.add(oe.leave),e.classList.add(oe.leaveActive))}reset(){this.zoom=this.config.nzZoom??this._defaultNzZoom,this.scaleStep=this.config.nzScaleStep??this._defaultNzScaleStep,this.rotate=this.config.nzRotate??this._defaultNzRotate,this.position=z({},ae)}};n.\u0275fac=function(t){return new(t||n)(l(we),l(se),l(L),l(K),l(B),l(Y),l(X),l(Ae))},n.\u0275cmp=I({type:n,selectors:[["nz-image-preview"]],viewQuery:function(t,o){if(t&1&&(V(Xt,5),V(Yt,7)),t&2){let r;A(r=U())&&(o.imageRef=r.first),A(r=U())&&(o.imagePreviewWrapper=r.first)}},hostAttrs:["tabindex","-1","role","document",1,"ant-image-preview-wrap"],hostVars:6,hostBindings:function(t,o){t&1&&Oe("@fadeMotion.start",function(m){return o.onAnimationStart(m)})("@fadeMotion.done",function(m){return o.onAnimationDone(m)}),t&2&&(De("@.disabled",o.config.nzNoAnimation)("@fadeMotion",o.animationState),W("z-index",o.config.nzZIndex),R("ant-image-preview-moving",o.isDragging))},exportAs:["nzImagePreview"],standalone:!0,features:[Pe([X]),E],decls:11,vars:6,consts:[[1,"ant-image-preview"],["tabindex","0","aria-hidden","true",2,"width","0","height","0","overflow","hidden","outline","none"],[1,"ant-image-preview-content"],[1,"ant-image-preview-body"],[1,"ant-image-preview-operations"],["class","ant-image-preview-operations-operation",3,"ant-image-preview-operations-operation-disabled","click",4,"ngFor","ngForOf"],["cdkDrag","",1,"ant-image-preview-img-wrapper",3,"cdkDragFreeDragPosition","cdkDragReleased"],["imagePreviewWrapper",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"ant-image-preview-operations-operation",3,"click"],["nz-icon","","nzTheme","outline",1,"ant-image-preview-operations-icon",3,"nzType"],["cdkDragHandle","","class","ant-image-preview-img",3,"width","height","transform",4,"ngIf"],["cdkDragHandle","",1,"ant-image-preview-img"],["imgRef",""],[1,"ant-image-preview-switch-left",3,"click"],["nz-icon","","nzType","left","nzTheme","outline"],[1,"ant-image-preview-switch-right",3,"click"],["nz-icon","","nzType","right","nzTheme","outline"]],template:function(t,o){t&1&&(c(0,"div",0),C(1,"div",1),c(2,"div",2)(3,"div",3)(4,"ul",4),_(5,Jt,2,3,"li",5),s(),c(6,"div",6,7),f("cdkDragReleased",function(){return o.onDragReleased()}),_(8,ti,2,1,"ng-container",8),s(),_(9,ii,5,4,"ng-container",9),s()(),C(10,"div",1),s()),t&2&&(p(5),g("ngForOf",o.operations),p(1),W("transform",o.previewImageWrapperTransform),g("cdkDragFreeDragPosition",o.position),p(2),g("ngForOf",o.images),p(1),g("ngIf",o.images.length>1))},dependencies:[Le,it,tt,bt,zt,Re],encapsulation:2,data:{animation:[et]},changeDetection:0});let i=n;return i})(),ue=class{constructor(n,a,e){this.previewInstance=n,this.config=a,this.overlayRef=e,this.destroy$=new j,e.keydownEvents().pipe(re(t=>this.config.nzKeyboard&&(t.keyCode===27||t.keyCode===37||t.keyCode===39)&&!nt(t))).subscribe(t=>{t.preventDefault(),t.keyCode===27&&this.close(),t.keyCode===37&&this.prev(),t.keyCode===39&&this.next()}),e.detachments().subscribe(()=>{this.overlayRef.dispose()}),n.containerClick.pipe(Z(1),b(this.destroy$)).subscribe(()=>{this.close()}),n.closeClick.pipe(Z(1),b(this.destroy$)).subscribe(()=>{this.close()}),n.animationStateChanged.pipe(re(t=>t.phaseName==="done"&&t.toState==="leave"),Z(1)).subscribe(()=>{this.dispose()})}switchTo(n){this.previewInstance.switchTo(n)}next(){this.previewInstance.next()}prev(){this.previewInstance.prev()}close(){this.previewInstance.startLeaveAnimation()}dispose(){this.destroy$.next(),this.overlayRef.dispose()}},Zt=(()=>{let n=class n{constructor(e,t,o,r){this.overlay=e,this.injector=t,this.nzConfigService=o,this.directionality=r}preview(e,t,o){return this.display(e,t,o)}display(e,t,o){let r=z(z({},new B),t??{}),m=this.createOverlay(r),d=this.attachPreviewComponent(m,r);d.setImages(e,o);let v=new ue(d,r,m);return d.previewRef=v,v}attachPreviewComponent(e,t){let o=H.create({parent:this.injector,providers:[{provide:Y,useValue:e},{provide:B,useValue:t}]}),r=new Je(Qt,null,o);return e.attach(r).instance}createOverlay(e){let t=this.nzConfigService.getConfigForComponent(Bt)||{},o=new ot({hasBackdrop:!0,scrollStrategy:this.overlay.scrollStrategies.block(),positionStrategy:this.overlay.position().global(),disposeOnNavigation:e.nzCloseOnNavigation??t.nzCloseOnNavigation??!0,backdropClass:oi,direction:e.nzDirection||t.nzDirection||this.directionality.value});return this.overlay.create(o)}};n.\u0275fac=function(t){return new(t||n)(M(at),M(H),M(K),M(de,8))},n.\u0275prov=ve({token:n,factory:n.\u0275fac});let i=n;return i})(),mi=(()=>{let n=class n{constructor(){this.nzScaleStep=null,this.images=[]}addImage(e){this.images.push(e)}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=I({type:n,selectors:[["nz-image-group"]],inputs:{nzScaleStep:"nzScaleStep"},exportAs:["nzImageGroup"],standalone:!0,features:[E],ngContentSelectors:ni,decls:1,vars:0,template:function(t,o){t&1&&(Ne(),Te(0))},encapsulation:2,changeDetection:0});let i=n;return i})(),di="image",Ht=(()=>{let n=class n{get previewable(){return!this.nzDisablePreview&&this.status!=="error"}constructor(e,t,o,r,m,d,v){this.document=e,this.nzConfigService=t,this.elementRef=o,this.nzImageService=r,this.cdr=m,this.parentGroup=d,this.directionality=v,this._nzModuleName=di,this.nzSrc="",this.nzSrcset="",this.nzDisablePreview=!1,this.nzFallback=null,this.nzPlaceholder=null,this.nzScaleStep=null,this.status="normal",this.backLoadDestroy$=new j,this.destroy$=new j}ngOnInit(){this.backLoad(),this.parentGroup&&this.parentGroup.addImage(this),this.directionality&&(this.directionality.change?.pipe(b(this.destroy$)).subscribe(e=>{this.dir=e,this.cdr.detectChanges()}),this.dir=this.directionality.value)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onPreview(){if(this.previewable)if(this.parentGroup){let e=this.parentGroup.images.filter(d=>d.previewable),t=e.map(d=>({src:d.nzSrc,srcset:d.nzSrcset})),o=e.findIndex(d=>this===d),r=new Map;e.forEach(d=>{r.set(d.nzSrc??d.nzSrcset,d.nzScaleStep??this.parentGroup.nzScaleStep??this.nzScaleStep??he)}),this.nzImageService.preview(t,{nzDirection:this.dir},r).switchTo(o)}else{let e=[{src:this.nzSrc,srcset:this.nzSrcset}];this.nzImageService.preview(e,{nzDirection:this.dir,nzScaleStep:this.nzScaleStep??he})}}getElement(){return this.elementRef}ngOnChanges(e){let{nzSrc:t}=e;t&&(this.getElement().nativeElement.src=t.currentValue,this.backLoad())}backLoad(){this.backLoadImage=this.document.createElement("img"),this.backLoadImage.src=this.nzSrc,this.backLoadImage.srcset=this.nzSrcset,this.status="loading",this.backLoadDestroy$.next(),this.backLoadDestroy$.complete(),this.backLoadDestroy$=new j,this.backLoadImage.complete?(this.status="normal",this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset):(this.nzPlaceholder?(this.getElement().nativeElement.src=this.nzPlaceholder,this.getElement().nativeElement.srcset=""):(this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset),F(this.backLoadImage,"load").pipe(b(this.backLoadDestroy$),b(this.destroy$)).subscribe(()=>{this.status="normal",this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset}),F(this.backLoadImage,"error").pipe(b(this.backLoadDestroy$),b(this.destroy$)).subscribe(()=>{this.status="error",this.nzFallback&&(this.getElement().nativeElement.src=this.nzFallback,this.getElement().nativeElement.srcset="")}))}};n.\u0275fac=function(t){return new(t||n)(l(Fe),l(K),l(se),l(Zt),l(L),l(mi,8),l(de,8))},n.\u0275dir=ze({type:n,selectors:[["img","nz-image",""]],hostBindings:function(t,o){t&1&&f("click",function(){return o.onPreview()})},inputs:{nzSrc:"nzSrc",nzSrcset:"nzSrcset",nzDisablePreview:"nzDisablePreview",nzFallback:"nzFallback",nzPlaceholder:"nzPlaceholder",nzScaleStep:"nzScaleStep"},exportAs:["nzImage"],standalone:!0,features:[xe]});let i=n;return P([Xe(),$()],i.prototype,"nzDisablePreview",void 0),P([$()],i.prototype,"nzFallback",void 0),P([$()],i.prototype,"nzPlaceholder",void 0),P([$()],i.prototype,"nzScaleStep",void 0),i})(),Wt=(()=>{let n=class n{};n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=be({type:n}),n.\u0275inj=Ce({providers:[Zt],imports:[Qt]});let i=n;return i})();function gi(i,n){if(i&1&&C(0,"img",9),i&2){let a=h().$implicit,e=h(2);g("nzSrc",e.getFileUrl(a.value.questionId))}}function fi(i,n){if(i&1&&(c(0,"tr",8)(1,"td"),u(2),s(),c(3,"td"),u(4),s(),c(5,"td"),u(6),s(),c(7,"td"),u(8),s(),c(9,"td"),u(10),s(),c(11,"td"),_(12,gi,1,1,"img",9),s(),c(13,"td")(14,"nz-form-item",10)(15,"nz-form-control"),C(16,"input",11),s()()(),c(17,"td")(18,"nz-form-item",10)(19,"nz-form-control"),C(20,"input",12),s()()()()),i&2){let a=n.$implicit,e=n.$index,t=h(2),o,r,m,d,v;g("formGroupName",e),p(2),N((o=t.getExamineObjectQuestion(a.value.questionId))==null?null:o.question.no),p(2),N((r=t.getExamineObjectQuestion(a.value.questionId))==null?null:r.question.catalog),p(2),N((m=t.getExamineObjectQuestion(a.value.questionId))==null?null:m.question.job),p(2),N((d=t.getExamineObjectQuestion(a.value.questionId))==null?null:d.question.integral),p(2),N((v=t.getExamineObjectQuestion(a.value.questionId))==null?null:v.content),p(2),k(12,t.getFileUrl(a.value.questionId)?12:-1)}}var vi=()=>({x:"auto",y:"60vh"});function Ci(i,n){if(i&1&&(D(0),c(1,"form",2)(2,"nz-table",3,4)(4,"thead")(5,"tr")(6,"th",5),u(7,"\u7F16\u53F7"),s(),c(8,"th",5),u(9,"\u7F16\u53F7\u53CA\u7C7B\u522B"),s(),c(10,"th",6),u(11,"\u7F16\u53F7\u53CA\u4EFB\u52A1\u9879"),s(),c(12,"th"),u(13,"\u5206\u6570"),s(),c(14,"th"),u(15,"\u5B8C\u6210\u60C5\u51B5"),s(),c(16,"th"),u(17,"\u9644\u4EF6"),s(),c(18,"th"),u(19,"\u52A0\u5206"),s(),c(20,"th"),u(21,"\u51CF\u5206"),s()()(),c(22,"tbody"),D(23,7),Ee(24,fi,21,7,"tr",8,ye),O(),s()()(),O()),i&2){let a=h();p(1),g("formGroup",a.validateForm),p(1),g("nzScroll",ce(4,vi))("nzBordered",!0)("nzFrontPagination",!1),p(22),ke(a.validateForm.controls.items.controls)}}var _i=()=>({padding:"15px",height:"70vh","max-height":"100vh"}),qt=(()=>{let n=class n{get isVisible(){return this._isVisible}set isVisible(e){this._isVisible=e,e&&this.getAll()}constructor(e,t){this.examineObjectQuestionClient=e,this.fb=t,this._isVisible=!1,this.isVisibleChange=new y,this.onSuccess=new y,this.examineObjectQuestions=[],this.validateForm=this.fb.group({examineId:[],objectId:[],items:this.fb.array([])})}ngOnInit(){}getAll(){this.examineObjectQuestionClient.getAll(this.examineObjectDto?.examineId,this.examineObjectDto?.objectId).subscribe(e=>{this.examineObjectQuestions=e,this.validateForm.patchValue({examineId:this.examineObjectDto.examineId,objectId:this.examineObjectDto.objectId});for(let t of e)this.createNewRow({questionId:t.questionId,integral:t.question.integral})})}getExamineObjectQuestion(e){return this.examineObjectQuestions.find(t=>t.questionId==e)}getFileUrl(e){let t=this.getExamineObjectQuestion(e);return!t||!t.fileUrl?null:this.examineObjectQuestionClient.getBaseUrl("")+t.fileUrl}createNewRow(e){var t=this.fb.group({questionId:[],integral:[0],addIntegral:[0],subIntegral:[0]});e&&t.patchValue(e),this.validateForm.controls.items.push(t)}handleCancel(){this.validateForm.controls.items.clear(),this.validateForm.reset(),this.isVisibleChange.emit(!1)}handleOk(){Ye(this.validateForm)&&this.examineObjectQuestionClient.pend1(Object.assign(this.validateForm.value)).subscribe(e=>{this.onSuccess.emit(),this.handleCancel()})}};n.\u0275fac=function(t){return new(t||n)(l(ie),l(Ke))},n.\u0275cmp=I({type:n,selectors:[["app-check-examine"]],inputs:{examineObjectDto:"examineObjectDto",isVisible:"isVisible"},outputs:{isVisibleChange:"isVisibleChange",onSuccess:"onSuccess"},standalone:!0,features:[E],decls:2,vars:3,consts:[["nzTitle","\u8003\u6838\u5BA1\u6838","nzWidth","60%",3,"nzVisible","nzBodyStyle","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],["nz-form","",3,"formGroup"],["nzSize","small","nzTemplateMode","",3,"nzScroll","nzBordered","nzFrontPagination"],["basicTable",""],["nzWidth","100px"],["nzWidth","300px"],["formArrayName","items"],[3,"formGroupName"],["nz-image","","width","200px","height","200px","alt","",3,"nzSrc"],[1,"form-item"],["nz-input","","formControlName","addIntegral"],["nz-input","","formControlName","subIntegral"]],template:function(t,o){t&1&&(c(0,"nz-modal",0),f("nzVisibleChange",function(m){return o.isVisible=m})("nzOnCancel",function(){return o.handleCancel()})("nzOnOk",function(){return o.handleOk()}),_(1,Ci,26,5,"ng-container",1),s()),t&2&&g("nzVisible",o.isVisible)("nzBodyStyle",ce(2,_i))},dependencies:[q,Ze,$e,Be,Qe,G,He,Ge,We,qe,ee,mt,lt,pt,dt,ht,wt,St,xt,ne,te,ut,Mt,Lt,yt,jt,Dt,Et,kt,Tt,Ot,Nt,J,Wt,Ht],styles:[".form-wrap[_ngcontent-%COMP%]{padding:15px}[readonly][_ngcontent-%COMP%]{background-color:#efefef}.form-item[_ngcontent-%COMP%]{margin-bottom:0!important}"]});let i=n;return i})();var bi=["operationTpl"];function zi(i,n){if(i&1){let a=w();c(0,"span",8),f("click",function(){x(a);let t=h().item,o=h();return S(o.handExamine(t))}),u(1,"\u8003\u6838"),s()}}function xi(i,n){if(i&1){let a=w();c(0,"span",8),f("click",function(){x(a);let t=h().item,o=h();return S(o.handExamine(t))}),u(1,"\u8003\u6838"),s()}}function Si(i,n){if(i&1){let a=w();c(0,"span",8),f("click",function(){x(a);let t=h().item,o=h();return S(o.handPend2(t))}),u(1,"\u5BA1\u6838"),s()}}function wi(i,n){if(i&1&&_(0,zi,2,0,"span",7)(1,xi,2,0,"span",7)(2,Si,2,0,"span",7),i&2){let a=n.item,e=h();k(0,a.status==1&&e.examineDto.examineType==0&&e.currentUser.positionType==1&&a.objectId==e.currentUser.ouId?0:-1),p(1),k(1,a.status==1&&e.examineDto.examineType==1&&e.currentUser.positionType==1&&e.currentUser.ouId==a.ouId?1:-1),p(1),k(2,e.examineDto.examineType==0&&a.status==3&&(e.currentUserOu==null?null:e.currentUserOu.ouType)==3?2:-1)}}function Ii(i,n){if(i&1){let a=w();c(0,"button",9),f("click",function(){x(a);let t=h();return S(t.back())}),u(1,"\u8FD4\u56DE"),s()}}var Wn=(()=>{let n=class n{constructor(e,t,o,r,m,d,v,Q,T,Gt,Kt){this.modalService=e,this.client=t,this.userClient=o,this.ouClient=r,this.examineClient=m,this.examineObjectQuestionClient=d,this.activeRoute=v,this.router=Q,this.location=T,this.userService=Gt,this.nzModalService=Kt,this.pageHeaderInfo={breadcrumb:["\u9996\u9875","\u5B66\u4E60\u5E73\u53F0","\u5728\u7EBF\u8003\u6838"]},this.dataList=[],this.searchParam={examineId:""},this.cdr=_e(L),this.isExmaineVisible=!1}ngOnInit(){this.activeRoute.queryParams.subscribe(e=>{this.searchParam.examineId=e.examineId,this.initTable(),this.getExamine(e.examineId)}),this.userService.getUserInfo().subscribe(e=>{this.currentUser=e,this.currentUser.userId&&this.getUserOu()})}getUserOu(){this.userClient.get(this.currentUser.userId).pipe(fe(e=>this.ouClient.get(e.ouId))).subscribe(e=>{this.currentUserOu=e})}getExamine(e){this.examineClient.get(e).subscribe(t=>{this.examineDto=t})}initTable(){this.tableConfig={headers:[{title:"\u8003\u6838\u5BF9\u8C61",field:"name",width:200},{title:"\u72B6\u6001",field:"statusDesc",width:200},{title:"\u6700\u7EC8\u79EF\u5206",field:"integral",width:200},{title:"\u64CD\u4F5C",tdTemplate:this.operationTpl,width:120,fixed:!0,fixedDir:"right"}],total:0,showCheckbox:!1,loading:!1,pageSize:10,pageIndex:1}}resetForm(){this.searchParam={examineId:this.searchParam.examineId},this.getDataList()}getDataList(e){this.tableConfig.loading=!0,this.searchParam.page={pageSize:this.tableConfig.pageSize,pageIndex:e?.pageIndex||this.tableConfig.pageIndex},this.client.list(this.searchParam).pipe(ge(()=>{this.tableLoading(!1)})).subscribe(t=>{let{items:o,page:r}=t;this.dataList=[...o],this.tableConfig.total=r.totalCount,this.tableConfig.pageIndex=r.pageIndex,this.tableLoading(!1)})}tableLoading(e){this.tableConfig.loading=e,this.tableChangeDectction()}tableChangeDectction(){this.dataList=[...this.dataList],this.cdr.detectChanges()}changePageSize(e){this.tableConfig.pageSize=e}back(){this.location.back()}handExamine(e){this.currentExamineObject=e,this.isExmaineVisible=!0}handPend2(e){this.nzModalService.confirm({nzTitle:"\u662F\u5426\u5BA1\u6838\u901A\u8FC7?",nzOkText:"\u901A\u8FC7",nzCancelText:"\u4E0D\u901A\u8FC7",nzOnOk:()=>{this.pend2(e,!0)},nzOnCancel:()=>{this.pend2(e,!1)}})}pend2(e,t){this.examineObjectQuestionClient.pend2({examineId:e.examineId,objectId:e.objectId,allow:t}).subscribe(o=>{this.getDataList()})}};n.\u0275fac=function(t){return new(t||n)(l(pe),l(ft),l(Ct),l(vt),l(gt),l(ie),l(Ve),l(Ue),l(Me),l(rt),l(pe))},n.\u0275cmp=I({type:n,selectors:[["app-examine-object-list"]],viewQuery:function(t,o){if(t&1&&V(bi,7),t&2){let r;A(r=U())&&(o.operationTpl=r.first)}},standalone:!0,features:[E],decls:9,vars:7,consts:[[3,"pageHeaderInfo"],[1,"normal-table-wrap"],[3,"btnTpl","tableTitle","reload"],[3,"tableConfig","tableData","changePageNum","changePageSize"],["operationTpl",""],["tableBtns",""],[3,"examineObjectDto","isVisible","isVisibleChange","onSuccess"],["class","operate-text"],[1,"operate-text",3,"click"],["nz-button","","nzType","link","nzSize","small",3,"click"]],template:function(t,o){if(t&1&&(C(0,"app-page-header",0),c(1,"div",1)(2,"app-card-table-wrap",2),f("reload",function(){return o.getDataList()}),c(3,"app-ant-table",3),f("changePageNum",function(m){return o.getDataList(m)})("changePageSize",function(m){return o.changePageSize(m)}),s(),_(4,wi,3,3,"ng-template",null,4,le),s()(),_(6,Ii,2,0,"ng-template",null,5,le),c(8,"app-check-examine",6),f("isVisibleChange",function(m){return o.isExmaineVisible=m})("onSuccess",function(){return o.getDataList()}),s()),t&2){let r=je(7);g("pageHeaderInfo",o.pageHeaderInfo),p(2),g("btnTpl",r)("tableTitle","\u5728\u7EBF\u8003\u6838\u5217\u8868"),p(1),g("tableConfig",o.tableConfig)("tableData",o.dataList),p(5),g("examineObjectDto",o.currentExamineObject)("isVisible",o.isExmaineVisible)}},dependencies:[J,ct,st,It,Ft,Pt,_t,ee,q,G,te,ne,qt]});let i=n;return i})();export{Wn as ExamineObjectListComponent};
